# ENS Domains Bug Bounty - Initial Reconnaissance Findings

**Date**: 2026-01-24
**Target**: https://ens.domains / https://app.ens.domains
**Program**: Immunefi Bug Bounty

---

## Executive Summary

Initial reconnaissance of the ENS domains web application has been completed. The application is well-protected with Cloudflare security measures, and uses modern web technologies (Next.js, React). Several areas of interest have been identified for further investigation.

---

## 1. Live Assets Identified

| Domain | Status | Notes |
|--------|--------|-------|
| ens.domains | 200 OK | Main landing page |
| app.ens.domains | 200 OK | Main application (Web3 wallet interaction) |
| docs.ens.domains | 503 Error | TLS certificate verification failure |
| support.ens.domains | 503 Error | TLS certificate verification failure |
| discuss.ens.domains | Unknown | Community forums |
| chat.ens.domains | Unknown | Discord redirect |

---

## 2. Technology Stack

### Frontend
- **Framework**: Next.js (React)
- **Build ID**: 5541991ed43fa7b39b483d8910e39b6528f19210
- **Styling**: Styled Components (CSS-in-JS)
- **Web3**: Rainbow Kit for wallet connection
- **Analytics**: Plausible Analytics (privacy-focused)

### Security
- **CDN/WAF**: Cloudflare (challenge platform active)
- **Server**: Envoy proxy
- **HSTS**: Enabled (max-age=2592000)

---

## 3. Findings of Interest

### 3.1 CORS Configuration (Informational/Low)
**Observation**: Permissive CORS header detected
```
access-control-allow-origin: *
```
**Impact**: This allows any origin to make requests to the API. While common for public APIs, it could potentially be leveraged in combination with other vulnerabilities.

**Recommendation**: Review if wildcard CORS is necessary for all endpoints.

---

### 3.2 Subdomain TLS Certificate Issues (Potential Medium-High)
**Observation**: docs.ens.domains and support.ens.domains return TLS certificate verification failures:
```
TLS_error: CERTIFICATE_VERIFY_FAILED: verify cert failed: verify SAN list
```

**Potential Impact**:
- These subdomains may be pointing to defunct services
- Could indicate potential for subdomain takeover if DNS records point to unclaimed resources
- Currently returns 503 which prevents exploitation

**Recommended Next Steps**:
- Check DNS records for these subdomains
- Verify if they point to third-party services that can be claimed
- Test if certificate mismatch allows any bypass

---

### 3.3 Application Endpoints Discovered
| Endpoint | Response | Notes |
|----------|----------|-------|
| /robots.txt | 68 bytes | Allows all, references sitemap |
| /sitemap.xml | 5345 bytes | Contains indexed URLs |
| /register | 27121 bytes | ENS name registration |
| /profile | 27389 bytes | User profile page |
| /import | 26554 bytes | ENS import functionality |
| /ensv2 | Standard | ENS v2 information |

---

### 3.4 Cloudflare Protection
**Observation**: Active Cloudflare challenge platform detected
```javascript
window.__CF$cv$params={r:'9c2f41f61fe545f5',t:'MTc2OTI1NDg0Mw=='};
```

**Impact**:
- Automated scanning may be blocked/limited
- Some attack vectors may be mitigated by WAF rules
- Manual testing recommended for sensitive checks

---

## 4. XSS/Injection Testing Results

### Path-based Injection
- **Result**: No reflection detected
- **Application returns**: Clean 404 page with no user input reflected
- **Status**: Well-handled

### Parameter Testing
- **Tested**: redirect, url, next parameters
- **Result**: No open redirect behavior detected
- **Status**: Well-handled

---

## 5. Recommended Next Steps

### High Priority
1. **Subdomain Takeover Investigation**:
   - Investigate docs.ens.domains and support.ens.domains further
   - Check DNS records (CNAME, A records)
   - Identify if they point to claimable third-party services

2. **Deep Web3 Testing**:
   - Test wallet interaction flows for transaction manipulation
   - Check for ENS name registration vulnerabilities
   - Test metadata injection in ENS records

### Medium Priority
3. **API Endpoint Discovery**:
   - Fuzz for hidden API endpoints
   - Test GraphQL if available
   - Check for information disclosure

4. **Client-side Security**:
   - Review JavaScript for sensitive data exposure
   - Check localStorage/sessionStorage handling
   - Test for DOM-based XSS

### Lower Priority
5. **Additional Subdomain Enumeration**:
   - Use certificate transparency logs
   - Brute-force additional subdomains
   - Check for development/staging environments

---

## 6. Tools Used
- Nuclei v3.3.5
- Subfinder v2.6.7
- httpx v1.6.9
- ffuf v2.1.0
- Dalfox v2.12.0
- Nmap v7.94
- Nikto v2.1.5
- curl v8.5.0

---

## 7. Notes
- Network connectivity issues observed during scanning (some DNS resolution failures)
- Cloudflare protection may be rate-limiting automated tools
- Manual testing recommended for high-value targets

---

**Status**: Initial reconnaissance complete. Ready for deep-dive testing.
